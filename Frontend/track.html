<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Track Complaints - Bank Grievance System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
    font-family: Arial, sans-serif;
    background: #0f2027;
    color: white;
    padding: 20px;
}
h1 { text-align:center; margin-bottom: 20px; }
input, select { padding:8px; border-radius:6px; margin-right:10px; margin-bottom:20px; }
.complaint-card {
    background: rgba(255,255,255,0.15);
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 15px;
}
.status { font-weight:bold; padding:5px 10px; border-radius:8px; display:inline-block; }
.pending { background: orange; color:#fff; }
.resolved { background: lightgreen; color:#000; }
.resolve-btn { padding:6px 12px; border:none; border-radius:6px; cursor:pointer; margin-top:8px; background:#00c6ff; color:white; }
.resolve-btn:hover { background:#0072ff; }
.logout-btn { position:fixed; top:20px; right:20px; background:red; color:white; padding:10px; cursor:pointer; }
a { color:#00c6ff; text-decoration:none; display:block; margin-top:20px; }
a:hover { text-decoration:underline; }
</style>
</head>
<body>

<button class="logout-btn" onclick="logout()">Logout</button>
<h1>Track Complaints</h1>

<!-- Search & Filter -->
<input type="text" id="searchInput" placeholder="Search by Account, Type or Description">
<select id="statusFilter">
    <option value="All">All Status</option>
    <option value="Pending">Pending</option>
    <option value="Resolved">Resolved</option>
</select>
<button onclick="applyFilter()">Search / Filter</button>

<div id="complaintList">
    <!-- Complaints will be loaded here -->
</div>

<a href="dashboard.html">Back to Dashboard</a>

<script>
// Preloaded 10 complaints
let complaints = [
    {id:1, account:"123456", type:"ATM Issue", description:"ATM not dispensing cash", status:"Pending"},
    {id:2, account:"234567", type:"Loan Delay", description:"Home loan approval delayed", status:"Resolved"},
    {id:3, account:"345678", type:"Net Banking", description:"Cannot login to net banking", status:"Pending"},
    {id:4, account:"456789", type:"Card Block", description:"Debit card blocked unexpectedly", status:"Resolved"},
    {id:5, account:"567890", type:"Fraud Alert", description:"Suspicious transaction alert", status:"Pending"},
    {id:6, account:"678901", type:"Account Closure", description:"Request to close account not processed", status:"Pending"},
    {id:7, account:"789012", type:"Cheque Issue", description:"Cheque not clearing", status:"Resolved"},
    {id:8, account:"890123", type:"UPI Failure", description:"UPI payments failing", status:"Pending"},
    {id:9, account:"901234", type:"KYC Update", description:"KYC update pending for 2 weeks", status:"Resolved"},
    {id:10, account:"012345", type:"Interest Rate", description:"Wrong interest calculation", status:"Pending"}
];

// Protect page: redirect if not logged in
if(localStorage.getItem("isLoggedIn") !== "true"){
    window.location.href = "login.html";
}

// Load complaints
function loadComplaints(list=complaints){
    let container = document.getElementById("complaintList");
    container.innerHTML = "";
    if(list.length === 0){
        container.innerHTML = "<p>No complaints found.</p>";
        return;
    }
    list.forEach(c => {
        let card = document.createElement("div");
        card.classList.add("complaint-card");
        card.innerHTML = `
            <p>ID: ${c.id}</p>
            <p>Account: ${c.account}</p>
            <p>Type: ${c.type}</p>
            <p>Description: ${c.description}</p>
            <p>Status: <span class="status ${c.status==='Pending'?'pending':'resolved'}">${c.status}</span></p>
        `;
        if(c.status === "Pending"){
            let btn = document.createElement("button");
            btn.classList.add("resolve-btn");
            btn.innerText = "Mark as Resolved";
            btn.onclick = function(){ resolve(c.id); };
            card.appendChild(btn);
        }
        container.appendChild(card);
    });
}

// Resolve a complaint
function resolve(id){
    let comp = complaints.find(c => c.id === id);
    if(comp){
        comp.status = "Resolved";
        loadComplaints();
        alert("Complaint marked as Resolved!");
    }
}

// Search / Filter
function applyFilter(){
    let keyword = document.getElementById("searchInput").value.toLowerCase();
    let status = document.getElementById("statusFilter").value;
    let filtered = complaints.filter(c => 
        (c.account.includes(keyword) || c.type.toLowerCase().includes(keyword) || c.description.toLowerCase().includes(keyword))
        && (status === "All" || c.status === status)
    );
    loadComplaints(filtered);
}

// Initial load
window.onload = function(){ loadComplaints(); };

// Logout
function logout(){
    localStorage.removeItem("isLoggedIn");
    window.location.href="login.html";
}
</script>

</body>
</html>